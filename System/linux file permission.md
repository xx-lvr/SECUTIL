## linux file permission
리눅스 파일 권한은 **파일이나 디렉토리에 접근할 수 있는 사용자와 그 권한의 종류를 정의하는 시스템**이라고 할 수 있다.

## 소유권 & 허가권 확인
![alt text](<../image/inpa linux file permission.png>)

## 파일 권한 정보(소유권/허가권)  확인하기(ls -l)
파일이나 디렉토리의 권한을 확인하기 위해 ```ls -l```명령어를 사용한다. ```ls -n```도 있다.
```
ls -l -rw-r--r--  1 chae  users  1203 Oct 29 09:12 test.txt
ls -n -rw-r--r--  1 1000  1000  1203 Oct 29 09:12 test.txt
```
이런 차이가 있다.

## 파일 유형
![alt text](<../image/file type.png>)
| 문자 값 | 파일 종류 설명 |
|:-------:|:-----------------------------|
| d | 디렉토리(Directory) |
| b | 블록 디바이스 파일 (하드 드라이브나 CD-ROM 등 블록 단위로 데이터 처리) |
| c | 문자 디바이스 파일 (터미널, 모뎀 등 바이트 단위로 데이터 처리) |
| l | 심볼릭 링크 파일(Symbolic Link) |
| p | 명명된 파이프(Named Pipe) |
| s | 유닉스 도메인 소켓(Unix Domain Socket) |
| - | 일반(정규) 파일(Regular File) |

## 허가권
| 문자값 | 파일 권한 설명 | 디렉토리 권한 설명 |
|:-------:|:-----------------------------|:--------------------------------|
| r (4) | 파일에 대한 **읽기 권한** — 파일을 열고 내용을 읽을 수 있음 | 디렉토리 내의 파일 목록을 나열할 수 있음 |
| w (2) | 파일에 대한 **쓰기 권한** — 파일 내용 수정, 잘라내기 가능 <br> (단, 파일 삭제·이름 변경은 디렉토리 권한에 의해 결정됨) | 디렉토리 내에서 파일을 **생성, 삭제, 이름 변경**할 수 있음 |
| x (1) | 파일에 대한 **실행 권한** — 프로그램 실행 가능 <br> (스크립트 파일은 읽기 권한도 필요) | 디렉토리 내에서 **이동 및 접근** 가능 (즉, 디렉토리에 들어올 수 있음) |

+ 참고 :  디렉토리는 **실행권한 x**를 꼭 가지고 있어야 해당 디렉토리로 이동 할 수 있다.

```
drwxr-xr--
```
+ d는 파일의 타입을 설명하고
+ rwx는 User의 권한
+ r-x는 Group의 권한
+ r--는 Other의 권한

## 소유권
각 파일이나 디렉터리를 소유할 사용자나 그룹을 지정.

## chmod(퍼미션 숫자)
chmod 명령어는 파일이나 디렉토리의 권한을 설정하는 데 사용된다. 권한은 숫자 혹은 문자로 표현할 수 있다.

| 10진수 | 2진수 | 기호 표현 | 권한 설명 |
|:-------:|:-------:|:---------:|:-----------|
| 0 | 000 | --- | 아무 권한 없음 |
| 1 | 001 | --x | 실행 권한만 있음 |
| 2 | 010 | -w- | 쓰기 권한만 있음 |
| 3 | 011 | -wx | 쓰기, 실행 권한 있음 |
| 4 | 100 | r-- | 읽기 권한만 있음 |
| 5 | 101 | r-x | 읽기, 실행 권한 있음 |
| 6 | 110 | rw- | 읽기, 쓰기 권한 있음 |
| 7 | 111 | rwx | 읽기, 쓰기, 실행 모든 권한 있음 |
```
# 사용자는 읽기,쓰기(4+2) 권한 부여하고, 
# 그룹과 다른사용자는 읽기(4) 권한만 부여
$ chmod 644 myfile.txt

# 권한 전부 주기
$ chmod 777 test.txt
```
### chomd(문자)
| 구분 | 의미 | 예시 |
|:------:|:------|:------|
| **r** | 읽기(Read) 권한 | 파일 내용 보기, 디렉토리 내 파일 목록 보기 |
| **w** | 쓰기(Write) 권한 | 파일 수정, 디렉토리 내 파일 생성·삭제 |
| **x** | 실행(Execute) 권한 | 파일 실행, 디렉토리 접근 |
| **+** | 권한 추가 | `chmod g+x file` → 그룹에 실행 권한 추가 |
| **-** | 권한 삭제 | `chmod o-w file` → 다른 사용자 쓰기 권한 제거 |
| **=** | 권한 지정(덮어쓰기) | `chmod u=rwx file` → 사용자에게 읽기·쓰기·실행 권한만 부여 |
| **u** | 사용자(User) | 파일 소유자 |
| **g** | 그룹(Group) | 파일이 속한 그룹 |
| **o** | 다른 사용자(Others) | 그 외 모든 사용자 |
| **a** | 모두(All) — u, g, o 모두 포함 | `chmod a+r file` → 모든 사용자에게 읽기 권한 추가 |

```
# 파일에 대하여 사용자(u)에 읽기 및 쓰기(rw)권한으로 초기화(=)
$ chmod u=rw myfile.txt

# 파일에 모두(a)에게 읽기,쓰기(rw) 권한으로 초기화(=)
$ chmod a=rw file.txt

# test.txt 의 소유자(u)에게 읽기(r) , 쓰기(w) 권한을 추가 부여(+)
$ chmod u+rw test.txt

# test.txt 의 소유그룹(g)에게 쓰기(w) 권한을 제거(-)
$ chmod g-w test.txt

# 그외 계정에게 모든 권한을 제거(-)
# rwx의 순서는 변경하여도 무방하다. o-rwx = o-wxr
$ chmod o-wxr test.txt
```

## 허가권 변경 chmod
| 옵션 | 의미 | 설명 |
|:------:|:------|:------|
| **-R**, **--recursive** | 재귀적 변경 | 특정 디렉터리 내의 모든 파일과 하위 디렉터리에 대해 **재귀적으로 권한 변경** |
| **-C**, **--changes** | 변경 내역 출력 | 권한이 **실제로 변경된 파일/디렉터리의 상세 정보**를 출력 |
| **-f**, **--silent**, **--quiet** | 에러 메시지 억제 | 대부분의 **에러 메시지 출력을 제한** (조용한 실행) |
| **--reference** | 참조 모드 사용 | 모드를 직접 지정하지 않고, **지정한 파일의 권한을 참조하여 동일하게 설정** |

```
# 디렉터리 이하의 모든 파일과 디렉터리에 대해 (-R)
# 사용자는 읽기, 쓰기, 실행(4+2+1) 권한을 부여하고 ,
# 그룹과 다른 사용자는 읽기 및 실행(4+1) 권한 부여
$ chmod -R 755 myfiles
```

## 사용자 및 그룹 소유권 변경 chown
+ 파일이나 디렉터리의 사용자 및 그룹의 소유권을 변경.
+ 소유권 변경은 **오직 루트 사용자**만 가능
```
$ chown [options] owner:[group] files
```
```
# test.txt 파일을 소유자를 root로
$ chown root test.txt

# 사용자는 myuser 그룹은 mygroup으로 파일 소유자 변경
$ sudo chown myuser:mygroup myfile.txt

# myfiles 디렉터리 이하 모든 파일 및 디렉터리에 대하여 사용자는 myuser, 그룹은 mygroup으로 소유자 변경
$ sudo chown -R myuser:mygroup myfiles
```